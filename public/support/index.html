<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PriceCheck Support</title>
  <meta name="description" content="Submit bug reports, request features, and vote on what PriceCheck builds next." />
  <link rel="canonical" href="https://www.pricechecktool.com/support/" />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />
  <meta name="googlebot" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />

  <meta property="og:site_name" content="PriceCheck" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="PriceCheck Support" />
  <meta property="og:description" content="Submit bug reports, request features, and vote on what PriceCheck builds next." />
  <meta property="og:url" content="https://www.pricechecktool.com/support/" />
  <meta property="og:image" content="https://www.pricechecktool.com/logo/logo.png" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="PriceCheck Support" />
  <meta name="twitter:description" content="Submit bug reports, request features, and vote on what PriceCheck builds next." />
  <meta name="twitter:image" content="https://www.pricechecktool.com/logo/logo.png" />

  <link rel="icon" type="image/png" href="/logo/logo.png" />
  <link rel="apple-touch-icon" href="/logo/logo.png" />
  <meta name="theme-color" content="#0b0f19" />

  <link rel="stylesheet" href="../styles.css" />

  <!-- Basic schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "PriceCheck Support",
    "description": "Submit bug reports, request features, and vote on what PriceCheck builds next.",
    "url": "https://www.pricechecktool.com/support/",
    "isPartOf": {
      "@type": "WebSite",
      "name": "PriceCheck",
      "url": "https://www.pricechecktool.com/"
    }
  }
  </script>

  <!-- Your existing scripts (keep these) -->
  <script src="/search.js" defer></script>
  <script src="/partials/partials.js" defer></script>

  <style>
    :root{
      --bg:#ffffff;
      --text:#0b0f19;
      --muted:#6b7280;
      --muted2:#9ca3af;
      --border:#e5e7eb;
      --card:#ffffff;
      --soft:#f8fafc;
      --shadow:0 10px 28px rgba(15, 23, 42, 0.08);
      --radius:18px;
      --radius2:22px;

      --accent-a:#66c7c5;
      --accent-b:#6f8cf5;
      --accent-c:#86d39a;

      --btn:#111827;
      --btnText:#ffffff;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:var(--bg);
      color:var(--text);
    }

    a{color:inherit; text-decoration:none}

    .container{
      max-width: 1120px;
      min-height: 900px;
      margin: 0 auto;
      padding: 0 18px 80px;
    }

    /* Hero */
    .hero{
      padding: 150px 0 50px;
      text-align:center;
      min-height: auto;
    }
    .hero h1{
      margin:0;
      font-size: clamp(42px, 6vw, 76px);
      letter-spacing: -1.2px;
      line-height: 1.05;
      font-weight: 600;
    }
    .gradient{
      background: linear-gradient(90deg, var(--accent-a), var(--accent-b), var(--accent-c));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero p{
      margin: 14px auto 0;
      max-width: 820px;
      font-size: 22px;
      color: var(--muted);
      line-height: 1.6;
    }

    .heroTabs{
      margin-top: 18px;
      display:flex;
      justify-content:center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn:hover {
        cursor: pointer;
        background-color: black;
        color: white;
    }
    .tabBtn{
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      border-radius: 14px;
      padding: 11px 14px;
      font-size: 18px;
      font-weight: 500;
      cursor:pointer;
      transition: transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
      min-width: 100px;
    }
    .tabBtn:hover{transform: translateY(-1px); box-shadow: 0 10px 18px rgba(15,23,42,0.08)}
    .tabBtn.active{
      background: var(--btn);
      color: var(--btnText);
      border-color: rgba(17,24,39,0.85);
      box-shadow: 0 14px 30px rgba(17,24,39,0.14);
    }

    /* Full-width panels */
    .panels{
      margin-top: 26px;
      display:flex;
      flex-direction:column;
      gap: 18px;
      align-items:stretch;
    }

    /* Cards */
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
      width: 100%;
    }
    .cardHeader{
      padding: 16px 16px 12px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      border-bottom: 1px solid var(--border);
      background: #fff;
    }
    .cardHeader h2{
      margin:0;
      font-size: 22px;
      font-weight: 600;
      letter-spacing: -0.3px;
    }
    .cardHeader p{
      margin: 6px 0 0;
      font-size: 18px;
      color: var(--muted);
      line-height: 1.5;
    }
    .cardBody{padding: 14px 16px 16px}

    /* Inputs */
    .row{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      margin-bottom: 12px;
    }

    .field{
      flex: 1 1 auto;
      min-width: 220px;
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .input, select, textarea{
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 11px 12px;
      font-size: 16px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      outline:none;
      background:#fff;
      color: var(--text);
    }
    textarea{min-height: 140px; resize: vertical}

    .label{
      font-size: 16px;
      color: var(--muted);
      margin: 18px 0 6px;
      display:block;
    }

    .seg{
      display:flex;
      gap: 8px;
      flex-wrap:wrap;
      margin-top: 10px;
    }
    .seg label{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      cursor:pointer;
      font-size: 16px;
      color: var(--text);
      user-select:none;
    }
    .seg input{margin:0}

    .help{
      font-size: 16px;
      color: var(--muted);
      line-height: 1.5;
      margin-top: 10px;
    }

    /* Issues list */
    .issues{
      display:flex;
      flex-direction:column;
      gap: 10px;
      margin-top: 6px;
    }

    .issue{
      display:grid;
      grid-template-columns: 56px 1fr;
      gap: 12px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      background: #fff;
    }

    .voteBox{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 6px;
      border-radius: 14px;
      min-height: 78px;
    }

    .voteBtn{
      width: 40px;
      height: 40px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #fff;
      cursor:pointer;
      display:grid;
      place-items:center;
      font-size: 16px;
      transition: transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
    }
    .voteBtn:hover{transform: translateY(-1px); box-shadow: 0 10px 18px rgba(15,23,42,0.08)}
    .voteBtn.active{
      border-color: rgba(102,199,197,0.65);
      box-shadow: 0 10px 18px rgba(111,140,245,0.10);
    }

    .score{
      font-size: 20px;
      font-weight: 600;
      color: var(--text);
      opacity: 0.9;
      font-variant-numeric: tabular-nums;
    }

    .issueMain{
      min-width:0;
      display: flex;
      flex-direction: column;
    }
    .issueTop{
      display:flex;
      gap: 10px;
      align-items:flex-start;
      justify-content:space-between;
    }
    .issueTitle{
      font-size: 24px;
      font-weight: 600;
      letter-spacing: -0.1px;
      margin: 0;
      overflow:visible;
      text-overflow:clip;
      white-space:normal;
      word-break: break-word;
    }
    .badges{
      display:flex;
      gap: 6px;
      justify-content:flex-end;
      align-items:center;
    }
    .badge{
      font-size: 14px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--soft);
      color: var(--muted);
      white-space:nowrap;
    }
    .badgeAccent{
      background: rgba(102,199,197,0.12);
      border-color: rgba(102,199,197,0.28);
      color: #0b3b36;
    }

    .issueBody{
      margin-top: 6px;
      color: var(--muted);
      font-size: 18px;
      line-height: 1.5;
      flex: 1 1 auto;
      white-space: pre-wrap;
      overflow: hidden;
      display: -webkit-box;
      -webkit-box-orient: vertical;
    }

    .issueFooter{
      margin-top: auto;
      padding-top: 8px;
      display:flex;
      align-items:center;
      justify-content:end;
      gap: 10px;
      flex-wrap:wrap;
    }
    .meta{
      font-size: 14px;
      color: var(--muted2);
    }

    .empty{
      padding: 12px 2px 0;
      font-size: 16px;
      color: var(--muted);
    }
  </style>
</head>

<body>
  <div id="site-header"></div>

  <main class="container">
    <section class="hero">
      <h1>PriceCheck Support</h1>
      <p>
        Your all in one shop for reporting bugs, proposing features, and voting on what PriceCheck builds next.
      </p>

      <div class="heroTabs" id="supportTabs" role="tablist" aria-label="Support sections">
        <button class="tabBtn active" id="tabBoard" type="button" role="tab" aria-selected="true" aria-controls="panelBoard">
          Explore
        </button>
        <button class="tabBtn" id="tabReport" type="button" role="tab" aria-selected="false" aria-controls="panelReport">
          Report
        </button>
         <button class="tabBtn" id="tabEmail" type="button" role="tab" aria-selected="false" aria-controls="panelEmail">
          Email
        </button>
      </div>
    </section>

    <section class="panels">
      <!-- Public board -->
      <div class="card" id="panelBoard" data-panel="board" role="tabpanel" aria-labelledby="tabBoard">
        <div class="cardHeader">
          <div>
            <h2>Explore Ideas</h2>
            <p>Public feed of ideas, issues and status notes.</p>
          </div>
        </div>

        <div class="cardBody">
          <div class="row">
            <div class="field" style="min-width:260px">
              <input class="input" id="q" type="text" placeholder="Search issues..." />
            </div>
            <div class="field" style="justify-content:flex-end">
                <select id="sort" style="width:160px">
                    <option value="top" selected>Top voted</option>
                    <option value="new">Newest</option>
                </select>

                <select id="status" style="width:180px">
                    <option value="all" selected>All</option>
                    <option value="open">Open</option>
                    <option value="investigating">Investigating</option>
                    <option value="planned">Planned</option>
                    <option value="fixed">Fixed</option>
                    <option value="closed">Closed</option>
                </select>
            </div>
          </div>

          <div class="issues" id="issues"></div>
          <div class="empty" id="emptyMsg" style="display:none"></div>
        </div>
      </div>

      <!-- Report form -->
      <div class="card" id="panelReport" data-panel="report" role="tabpanel" aria-labelledby="tabReport" style="display:none">
        <div class="cardHeader">
          <div>
            <h2>Submit Report</h2>
            <p>Do not include sensitive personal information. Changes cannot be made after submission.</p>
          </div>
        </div>

        <div class="cardBody">
          <label class="label" for="rTitle">Title</label>
          <input class="input" id="rTitle" type="text" placeholder="Short and specific" />

          <label class="label" for="rCategory">Category</label>
          <select id="rCategory">
            <option>Bug</option>
            <option>Feature</option>
            <option>UI</option>
            <option>Data</option>
            <option>Other</option>
          </select>

          <label class="label" for="rBody">Details</label>
          <textarea id="rBody" placeholder="What happened? Steps to reproduce? What did you expect? Please be as specific as you can."></textarea>

          <label class="label" for="rUrl">Page link (optional)</label>
          <input class="input" id="rUrl" type="text" placeholder="Paste the page where it happened" />

          <label class="label" for="rEmail">Email (optional)</label>
          <input class="input" id="rEmail" type="email" placeholder="Only if you want a reply" />

          <div class="seg" style="margin-top:12px">
            <label><input id="rPrivate" type="radio" name="vis" checked/> Private</label>
            <label><input id="rPublic" type="radio" name="vis" /> Public</label>
          </div>

          <div class="row" style="margin-top:28px">
            <button class="btn btnPrimary" id="btnSubmit" type="button" style="flex:1; font-size: 18px;">Submit</button>
            <button class="btn" id="btnClear" type="button" style="font-size: 18px;">Clear</button>
          </div>

          <div class="help" id="submitMsg"></div>
        </div>
      </div>

      <!-- Email -->
        <div class="card" id="panelEmail" data-panel="email" role="tabpanel" aria-labelledby="tabEmail" style="display:none">
        <div class="cardHeader">
            <div>
            <h2>Send Email</h2>
            <p>Email response times usually take longer than reporting. If you email, include links, screenshots, and any product IDs.</p>
            </div>
        </div>

        <div class="cardBody">
            <a class="btn btnPrimary" href="mailto:support@pricechecktool.com" style="display:inline-block; font-size:18px; padding:12px 16px; border-radius:14px;">
            Email PriceCheck
            </a>
        </div>
        </div>
    </section>
  </main>

    <div id="site-footer"></div>
  <script>
    const API = "/api/support";
    const $ = (id) => document.getElementById(id);

    const state = {
      issues: [],
      activePanel: "board"
    };

    function fmtTime(iso) {
      try { return new Date(iso).toLocaleString(); }
      catch { return iso || ""; }
    }

    async function api(path, opts = {}) {
      const headers = Object.assign(
        { "content-type": "application/json" },
        opts.headers || {}
      );

      const res = await fetch(path, Object.assign({}, opts, { headers }));
      const ct = res.headers.get("content-type") || "";
      const data = ct.includes("application/json") ? await res.json() : null;
      if (!res.ok) throw new Error(data?.error || "request_failed");
      return data;
    }

    function setActivePanel(next) {
        state.activePanel = next;

        const isBoard = next === "board";
        const isReport = next === "report";
        const isEmail = next === "email";

        $("panelBoard").style.display = isBoard ? "block" : "none";
        $("panelReport").style.display = isReport ? "block" : "none";
        $("panelEmail").style.display = isEmail ? "block" : "none";

        $("tabBoard").classList.toggle("active", isBoard);
        $("tabReport").classList.toggle("active", isReport);
        $("tabEmail").classList.toggle("active", isEmail);

        $("tabBoard").setAttribute("aria-selected", isBoard ? "true" : "false");
        $("tabReport").setAttribute("aria-selected", isReport ? "true" : "false");
        $("tabEmail").setAttribute("aria-selected", isEmail ? "true" : "false");
    }

    function badge(issue) {
      const badges = document.createElement("div");
      badges.className = "badges";

      const bCat = document.createElement("span");
      bCat.className = "badge";
      bCat.textContent = issue.category || "Bug";

      const bStatus = document.createElement("span");
      bStatus.className = "badge badgeAccent";
      bStatus.textContent = issue.status || "open";

      badges.appendChild(bCat);
      badges.appendChild(bStatus);
      return badges;
    }

    function issueCard(issue) {
      const wrap = document.createElement("div");
      wrap.className = "issue";

      const score = Number(issue.score || 0);
      const viewerVote = Number(issue.viewer_vote || 0);
      const canVote = Boolean(issue.is_public);

      const voteBox = document.createElement("div");
      voteBox.className = "voteBox";

      const up = document.createElement("button");
      up.className = "voteBtn" + (viewerVote === 1 ? " active" : "");
      up.type = "button";
      up.title = canVote ? "Upvote" : "Voting is for public posts";
      up.textContent = "▲";
      up.disabled = !canVote;

      const scoreEl = document.createElement("div");
      scoreEl.className = "score";
      scoreEl.textContent = String(score);

      const down = document.createElement("button");
      down.className = "voteBtn" + (viewerVote === -1 ? " active" : "");
      down.type = "button";
      down.title = canVote ? "Downvote" : "Voting is for public posts";
      down.textContent = "▼";
      down.disabled = !canVote;

      up.onclick = async () => {
        const next = viewerVote === 1 ? 0 : 1;
        const r = await api(`${API}/issues/${issue.id}/vote`, {
          method: "POST",
          body: JSON.stringify({ vote: next })
        });
        issue.score = r.score;
        issue.viewer_vote = r.viewer_vote;
        render();
      };

      down.onclick = async () => {
        const next = viewerVote === -1 ? 0 : -1;
        const r = await api(`${API}/issues/${issue.id}/vote`, {
          method: "POST",
          body: JSON.stringify({ vote: next })
        });
        issue.score = r.score;
        issue.viewer_vote = r.viewer_vote;
        render();
      };

      voteBox.appendChild(up);
      voteBox.appendChild(scoreEl);
      voteBox.appendChild(down);

      const main = document.createElement("div");
      main.className = "issueMain";

      const top = document.createElement("div");
      top.className = "issueTop";

      const title = document.createElement("h3");
      title.className = "issueTitle";
      title.textContent = issue.title || "Untitled";

      top.appendChild(title);
      top.appendChild(badge(issue));

      const body = document.createElement("div");
      body.className = "issueBody";
      body.textContent = issue.body || "";

      const footer = document.createElement("div");
      footer.className = "issueFooter";

      const meta = document.createElement("div");
      meta.className = "meta";
      meta.textContent = `${fmtTime(issue.created_at)} • #${issue.id}`;

      footer.appendChild(meta);

      main.appendChild(top);
      main.appendChild(body);
      main.appendChild(footer);

      wrap.appendChild(voteBox);
      wrap.appendChild(main);
      return wrap;
    }

    function render() {
      const list = $("issues");
      list.innerHTML = "";

      if (!state.issues.length) {
        $("emptyMsg").style.display = "block";
        $("emptyMsg").textContent = "No issues found. Try changing filters or submit a new one.";
      } else {
        $("emptyMsg").style.display = "none";
        state.issues.forEach((it) => list.appendChild(issueCard(it)));
      }
    }

    async function loadPublic() {
      const q = $("q").value.trim();
      const sort = $("sort").value;
      const status = $("status").value;

      const qs = new URLSearchParams();
      qs.set("sort", sort);
      qs.set("status", status);
      if (q) qs.set("q", q);

      const data = await api(`${API}/issues?${qs.toString()}`);
      state.issues = data.issues || [];
      render();
    }

    function clearReport() {
      $("rTitle").value = "";
      $("rBody").value = "";
      $("rUrl").value = "";
      $("rEmail").value = "";
      $("rCategory").value = "Bug";
      $("rPrivate").checked = true;
      $("submitMsg").textContent = "";
    }

    async function submitReport() {
      const title = $("rTitle").value.trim();
      const body = $("rBody").value.trim();
      const category = $("rCategory").value.trim();
      const isPublic = $("rPublic").checked;

      const sourceUrl = $("rUrl").value.trim();
      const email = $("rEmail").value.trim();

      $("submitMsg").textContent = "Submitting...";

      try {
        await api(`${API}/issues`, {
          method: "POST",
          body: JSON.stringify({
            title,
            body,
            category,
            is_public: isPublic,
            source_url: sourceUrl || null,
            reporter_email: email || null,
            app_version: null
          })
        });

        $("submitMsg").textContent = isPublic
          ? "Posted to the public board."
          : "Sent privately. Thanks, I will read it.";

        clearReport();
        await loadPublic();
        setActivePanel("board", { scroll: true });
      } catch (e) {
        $("submitMsg").textContent = `Error: ${e.message}`;
      }
    }

    // Wiring
    $("tabBoard").onclick = () => setActivePanel("board");
    $("tabReport").onclick = () => setActivePanel("report");
    $("tabEmail").onclick = () => setActivePanel("email");

    $("sort").addEventListener("change", () => loadPublic().catch(() => {}));
    $("status").addEventListener("change", () => loadPublic().catch(() => {}));

    $("q").addEventListener("keydown", (e) => {
      if (e.key === "Enter") loadPublic().catch(() => {});
    });

    $("btnSubmit").onclick = () => submitReport();
    $("btnClear").onclick = () => clearReport();

    // Boot
    (async () => {
      clearReport();
      setActivePanel("board", { scroll: false });
      await loadPublic();
    })();
  </script>
</body>
</html>
